<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Pickleball Scoreboard v2</title>
<style>
  :root {
    --bg-color: #121212;
    --card-bg: #1e1e1e;
    --accent: #4ade80;
    --text: #ffffff;
    --button-bg: #2d2d2d;
    --button-hover: #3e3e3e;
    --success: #22c55e;
    --error: #ef4444;
  }

  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    user-select: none;
  }

  body, html {
    height: 100%;
    width: 100%;
    overflow: hidden;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: var(--bg-color);
    color: var(--text);
    display: flex;
    justify-content: center;
    align-items: center;
  }

  #app {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    align-items: stretch;
    width: 90vw;
    max-width: 1000px;
    height: 80vh;
    border-radius: 2rem;
    overflow: hidden;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
    position: relative;
  }

  .side {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    align-items: center;
    background-color: var(--card-bg);
    padding: 2rem;
    border-radius: 1.5rem;
    margin: 1rem;
    box-shadow: inset 0 0 15px rgba(0,0,0,0.8);
  }

  .team-header {
    width: 100%;
    text-align: center;
  }

  .team-name {
    font-size: 2rem;
    font-weight: 700;
    background-color: #292929;
    border-radius: 1rem;
    color: var(--accent);
    text-align: center;
    padding: 0.3rem 0.6rem;
    user-select: text;
    outline: none;
    border: none;
    width: 100%;
    max-width: 12ch;
    margin: 0 auto;
    transition: background-color 0.3s;
  }
  .team-name:focus {
    background-color: #444;
    box-shadow: 0 0 10px var(--accent);
  }

  .score {
    font-size: 6rem;
    font-weight: bold;
    margin: 1rem 0;
    color: var(--accent);
    text-shadow: 0 0 10px var(--accent);
  }

  .buttons, .server-buttons {
    display: flex;
    gap: 1rem;
  }

  button {
    font-size: 2.2rem;
    padding: 1rem 2rem;
    border: none;
    border-radius: 1rem;
    background-color: var(--button-bg);
    color: var(--text);
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 4px 6px rgba(0,0,0,0.6);
  }

  button:hover:not(:disabled) {
    background-color: var(--button-hover);
    transform: scale(1.05);
  }

  button:disabled {
    cursor: default;
    background-color: #444;
    color: #888;
  }

  #controls {
    position: absolute;
    bottom: 1rem;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 1rem;
  }

  #controls button {
    font-size: 1.4rem;
    padding: 0.5rem 1.5rem;
    border-radius: 1rem;
    background-color: var(--button-bg);
    box-shadow: 0 4px 10px rgba(0,0,0,0.6);
    user-select: none;
  }
  #controls button:hover {
    background-color: var(--button-hover);
  }

  /* Fullscreen overlay and intro animation */
  #intro {
    position: fixed;
    inset: 0;
    background-color: var(--bg-color);
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 4rem;
    color: var(--accent);
    font-weight: 900;
    z-index: 9999;
    animation: fadeOut 1s ease forwards;
    animation-delay: 2s;
  }
  @keyframes fadeOut {
    to {
      opacity: 0;
      visibility: hidden;
    }
  }

  /* Visual feedback on score change */
  .score.bump {
    animation: bumpScale 0.25s ease forwards;
  }
  @keyframes bumpScale {
    0% { transform: scale(1); color: var(--accent);}
    50% { transform: scale(1.3); color: #22c55e; text-shadow: 0 0 20px #22c55e;}
    100% { transform: scale(1); color: var(--accent);}
  }

  /* Responsive */
  @media (max-width: 600px) {
    #app {
      flex-direction: column;
      height: 100vh;
      width: 100vw;
      margin: 0;
      border-radius: 0;
    }
    .side {
      margin: 0.5rem 0;
      height: 45vh;
    }
    .score {
      font-size: 4rem;
    }
    button {
      font-size: 1.8rem;
      padding: 0.8rem 1.5rem;
    }
    #controls {
      bottom: 0.5rem;
      flex-wrap: wrap;
      width: 90vw;
      left: 50%;
      transform: translateX(-50%);
    }
  }
</style>
</head>
<body>

<div id="intro">Pickleball Score</div>

<div id="app" tabindex="0" aria-label="Pickleball scoring app">
  <section class="side" id="teamA" aria-label="Team A side">
    <header class="team-header">
      <input aria-label="Team A name" id="teamAName" class="team-name" maxlength="12" spellcheck="false" value="Team A" />
    </header>
    <div class="score" id="scoreA" aria-live="polite" aria-atomic="true">0</div>
    <div class="buttons" role="group" aria-label="Team A score controls">
      <button id="btnAPlus" aria-label="Increase Team A score">+</button>
      <button id="btnAMinus" aria-label="Decrease Team A score">−</button>
    </div>
    <div class="server-buttons" role="group" aria-label="Team A server controls" style="margin-top: 1.5rem;">
      <button id="server1A" aria-label="Set Server 1 for Team A">Server 1</button>
      <button id="server2A" aria-label="Set Server 2 for Team A">Server 2</button>
    </div>
  </section>

  <section class="side" id="teamB" aria-label="Team B side">
    <header class="team-header">
      <input aria-label="Team B name" id="teamBName" class="team-name" maxlength="12" spellcheck="false" value="Team B" />
    </header>
    <div class="score" id="scoreB" aria-live="polite" aria-atomic="true">0</div>
    <div class="buttons" role="group" aria-label="Team B score controls">
      <button id="btnBPlus" aria-label="Increase Team B score">+</button>
      <button id="btnBMinus" aria-label="Decrease Team B score">−</button>
    </div>
    <div class="server-buttons" role="group" aria-label="Team B server controls" style="margin-top: 1.5rem;">
      <button id="server1B" aria-label="Set Server 1 for Team B">Server 1</button>
      <button id="server2B" aria-label="Set Server 2 for Team B">Server 2</button>
    </div>
  </section>
</div>

<div id="controls" role="region" aria-label="App controls">
  <button id="undoBtn" aria-label="Undo last score change">Undo</button>
  <button id="resetBtn" aria-label="Reset scores">Reset</button>
  <button id="fullscreenBtn" aria-label="Toggle fullscreen mode">Fullscreen</button>
</div>

<script>
(() => {
  'use strict';

  // Variables for state
  let scores = { A: 0, B: 0 };
  let history = [];
  let server = { A: null, B: null }; // can be 1 or 2
  let teamNames = { A: 'Team A', B: 'Team B' };
  const scoreLimit = 11;

  // Elements
  const scoreAEl = document.getElementById('scoreA');
  const scoreBEl = document.getElementById('scoreB');
  const teamANameEl = document.getElementById('teamAName');
  const teamBNameEl = document.getElementById('teamBName');

  const btnAPlus = document.getElementById('btnAPlus');
  const btnAMinus = document.getElementById('btnAMinus');
  const btnBPlus = document.getElementById('btnBPlus');
  const btnBMinus = document.getElementById('btnBMinus');

  const undoBtn = document.getElementById('undoBtn');
  const resetBtn = document.getElementById('resetBtn');
  const fullscreenBtn = document.getElementById('fullscreenBtn');

  const server1A = document.getElementById('server1A');
  const server2A = document.getElementById('server2A');
  const server1B = document.getElementById('server1B');
  const server2B = document.getElementById('server2B');

  const intro = document.getElementById('intro');
  const app = document.getElementById('app');

  // Utility functions
  function saveState() {
    localStorage.setItem('scores', JSON.stringify(scores));
    localStorage.setItem('history', JSON.stringify(history));
    localStorage.setItem('servers', JSON.stringify(server));
    localStorage.setItem('teamNames', JSON.stringify(teamNames));
  }

  function loadState() {
    const s = JSON.parse(localStorage.getItem('scores'));
    if(s && typeof s.A === 'number' && typeof s.B === 'number') scores = s;
    const h = JSON.parse(localStorage.getItem('history'));
    if(Array.isArray(h)) history = h;
    const serv = JSON.parse(localStorage.getItem('servers'));
    if(serv) server = serv;
    const tNames = JSON.parse(localStorage.getItem('teamNames'));
    if(tNames) {
      teamNames = tNames;
      teamANameEl.value = teamNames.A;
      teamBNameEl.value = teamNames.B;
    }
  }

  function updateScoreUI() {
    scoreAEl.textContent = scores.A;
    scoreBEl.textContent = scores.B;
  }

  function updateServerUI() {
    // Clear all server button highlights first
    [server1A, server2A, server1B, server2B].forEach(btn => btn.style.backgroundColor = '');

    if(server.A === 1) server1A.style.backgroundColor = 'var(--success)';
    if(server.A === 2) server2A.style.backgroundColor = 'var(--success)';
    if(server.B === 1) server1B.style.backgroundColor = 'var(--success)';
    if(server.B === 2) server2B.style.backgroundColor = 'var(--success)';
  }

  function updateNamesUI() {
    teamANameEl.value = teamNames.A;
    teamBNameEl.value = teamNames.B;
  }

  // Score change with history for undo
  function changeScore(team, delta) {
    if(delta === 0) return;
    // Prevent changing if game over
    if(isGameOver()) return;

    // Save current state to history
    history.push(JSON.stringify(scores));

    if(team === 'A') {
      scores.A = Math.max(0, scores.A + delta);
    } else if(team === 'B') {
      scores.B = Math.max(0, scores.B + delta);
    }

    updateScoreUI();
    highlightScore(team);
    saveState();

    if(isGameOver()) {
      alert(`${teamNames[team]} wins!`);
      disableScoreButtons(true);
    }
  }

  // Undo last score change
  function undo() {
    if(history.length === 0) return;
    const last = history.pop();
    scores = JSON.parse(last);
    updateScoreUI();
    disableScoreButtons(false);
    saveState();
  }

  // Reset scores and state
  function reset() {
    if(!confirm('Reset scores and servers?')) return;
    history = [];
    scores = { A: 0, B: 0 };
    server = { A: null, B: null };
    updateScoreUI();
    updateServerUI();
    disableScoreButtons(false);
    saveState();
  }

  // Check if game is over
  function isGameOver() {
    return scores.A >= scoreLimit || scores.B >= scoreLimit;
  }

  // Disable/enable score buttons on game over
  function disableScoreButtons(disable) {
    btnAPlus.disabled = disable;
    btnAMinus.disabled = disable;
    btnBPlus.disabled = disable;
    btnBMinus.disabled = disable;
  }

  // Visual score bump effect
  function highlightScore(team) {
    const el = team === 'A' ? scoreAEl : scoreBEl;
    el.classList.remove('bump');
    void el.offsetWidth; // trigger reflow for restart
    el.classList.add('bump');
  }

  // Set server for team
  function setServer(team, num) {
    server[team] = num;
    updateServerUI();
    saveState();
  }

  // Fullscreen toggle
  function toggleFullscreen() {
    if(!document.fullscreenElement) {
      app.requestFullscreen().catch(() => {});
    } else {
      document.exitFullscreen();
    }
  }

  // Load saved state on start
  loadState();
  updateScoreUI();
  updateServerUI();

  // Event Listeners
  btnAPlus.addEventListener('click', () => changeScore('A', +1));
  btnAMinus.addEventListener('click', () => changeScore('A', -1));
  btnBPlus.addEventListener('click', () => changeScore('B', +1));
  btnBMinus.addEventListener('click', () => changeScore('B', -1));

  undoBtn.addEventListener('click', undo);
  resetBtn.addEventListener('click', reset);
  fullscreenBtn.addEventListener('click', toggleFullscreen);

  server1A.addEventListener('click', () => setServer('A', 1));
  server2A.addEventListener('click', () => setServer('A', 2));
  server1B.addEventListener('click', () => setServer('B', 1));
  server2B.addEventListener('click', () => setServer('B', 2));

  // Editable team names with persistence
  teamANameEl.addEventListener('input', (e) => {
    teamNames.A = e.target.value.trim() || 'Team A';
    saveState();
  });
  teamBNameEl.addEventListener('input', (e) => {
    teamNames.B = e.target.value.trim() || 'Team B';
    saveState();
  });

  // Remove intro after animation
  intro.addEventListener('animationend', () => {
    intro.style.display = 'none';
  });

  // Keyboard shortcuts for accessibility (optional)
  document.addEventListener('keydown', (e) => {
    if(e.key === 'f' || e.key === 'F') toggleFullscreen();
    if(e.key === 'r' || e.key === 'R') reset();
    if(e.key === 'z' && (e.ctrlKey || e.metaKey)) undo();
  });

})();
</script>

</body>
</html>
